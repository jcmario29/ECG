Building Heart Rhythms Classification Device for Humans

Luis Moreno, Felipe Rivas, Mario Juarez
Mentor: Dr. Mustafa Al Lail
Department of Computer Engineering
Texas A&M International University
Laredo, TX 78045


Abstract
	With 17.9 million deaths per year, cardiovascular diseases (CVDs) are the leading cause of mortality worldwide. Having a device that can detect and classify heart rhythms will save a significant number of lives of people with CVDs. This device is important because it can diagnose and monitor heart conditions, such as arrhythmias, which are abnormal heart rhythms that can lead to serious health conditions or even death. The device that we are developing provides real-time information about a person's heart rhythm and allows for early detection and treatment of heart problems, preventing complications and improving treatment outcomes. Additionally, the device can improve patient comfort and convenience by avoiding the need for invasive procedures to monitor heart vital signals. Our goal is to build a heart rhythm classification device for humans’ that can accurately classify different heart rhythms. The device utilizes advanced signal processing techniques and machine learning algorithms to analyze the electrocardiogram (ECG) signal generated by the heart. We aim to provide an accessible and efficient method for identifying abnormal heart rhythms. By accurately classifying heart rhythms, this device has the potential to improve early diagnosis and treatment of heart conditions, ultimately leading to better patient’s quality of life. Moreover, the device is designed to be user-friendly and portable, allowing individuals to monitor their heart rhythm on the go. The device also integrates with a mobile application, which provides real-time heart rhythm information and allows for easy monitoring of heart health. The device can classify ECG signals with a 98.3% accuracy and a loss of 0.10%. We are currently working on improving the accuracy, and the graphical user interface. The application will provide personalized recommendations and alerts that can help individuals make informed decisions about their heart condition. We also envision integrating the device with wearable devices, such as smartwatches, to provide even more convenient heart rhythm monitoring. The development of this heart rhythm classification device will potentially revolutionize the way in which heart conditions are diagnosed and treated.

Keywords– Machine learning (ML), Convolution Neural Networks (CNN),  Cardiovascular diseases (CVDs)


Section 1: Introduction
	Cardiovascular diseases (CVDs) are the leading cause of mortality globally, causing 17.9 million deaths per year. A device that can detect and classify heart rhythms accurately has the potential to save many lives, as it can diagnose and monitor heart conditions such as arrhythmias, which can lead to serious health conditions or even death. The device that is being developed provides real-time information about a person's heart rhythm and allows for early detection and treatment of heart problems, ultimately leading to better patient outcomes. The device utilizes advanced signal processing techniques and machine learning algorithms to analyze the electrocardiogram (ECG) signal generated by the heart, aiming to provide an accessible and efficient method for identifying abnormal heart rhythms. The device can classify ECG signals with an accuracy of 98.3% and a loss of 0.10%, and the team is working on improving the accuracy and graphical user interface. The device integrates with a mobile application, which provides real-time heart rhythm information and allows for easy monitoring of heart health. The device's development has the potential to revolutionize the way in which heart conditions are diagnosed and treated, improving patient comfort and convenience by avoiding the need for invasive procedures to monitor heart vital signals.

Section 2: Preliminaries 
A. Machine Learning:
Machine Learning (ML) is a subfield of Artificial Intelligence (AI) that involves developing algorithms and models that enable machines to learn and make predictions based on data without being explicitly programmed. It involves using statistical techniques to extract patterns and relationships from data, and then using these patterns to make predictions or take actions. ML has become increasingly popular in recent years due to the explosion of data and the need to make sense of it.
B.  Machine Learning Algorithms:
There are several types of ML algorithms, including supervised learning, unsupervised learning, semi-supervised learning, and reinforcement learning. Supervised learning involves training a model on a labeled dataset, where the output variable is known, to make predictions on new, unlabeled data. Unsupervised learning involves training a model on an unlabeled dataset to discover patterns and relationships on its own. Semi-supervised learning combines both labeled and unlabeled data to improve prediction accuracy. Reinforcement learning involves training a model to make decisions in an environment and learn from feedback.
C.  Dataset
The dataset used in this study is a collection of electrocardiogram (ECG) recordings of different types of arrhythmias. The dataset contains over 10,000 ECG recordings and has been labeled by expert cardiologists to indicate the type of arrhythmia present in each recording.

D. Overview of Components
The main components of the machine learning model used in this study are Convolutional Neural Networks (CNNs). CNNs are a type of neural network that have been shown to be particularly effective at image classification tasks. They consist of multiple layers of neurons that perform convolutions on the input data to extract features, followed by pooling layers that reduce the dimensionality of the data, and finally fully connected layers that make predictions based on the extracted features. 

E. Overview of Arrhythmias
Arrhythmias are abnormal heart rhythms that can be classified into different types based on their origin and characteristics. Some of the most common types of arrhythmias include atrial fibrillation, ventricular tachycardia, and premature ventricular contractions. Each type of arrhythmia has its own distinctive pattern on an ECG recording, which can be used to diagnose the underlying condition. In this study, the machine learning model is trained to classify ECG recordings into one of several different types of arrhythmias based on their characteristic patterns.Atrial fibrillation (AFib): This is a type of irregular heartbeat that originates in the atria, the upper chambers of the heart. In AFib, the electrical signals that control the heartbeat become disorganized and rapid, causing the atria to quiver instead of contracting normally. This can lead to symptoms such as palpitations, shortness of breath, and fatigue, and it can increase the risk of stroke.
1.	Premature ventricular contractions (PVCs): These are extra heartbeats that originate in the ventricles, the lower chambers of the heart. PVCs can be harmless and go unnoticed, but they can also cause palpitations or a feeling of a skipped beat. They may occur in people with no underlying heart disease or may be associated with heart disease, electrolyte imbalances, or stimulant use.
2.	Ventricular tachycardia (VT): This is a type of rapid heartbeat that originates in the ventricles. In VT, the heart rate is usually between 100 and 250 beats per minute, and the heart can't pump blood effectively. VT can be life-threatening and may lead to cardiac arrest or sudden death. It may occur in people with structural heart disease, such as prior heart attack or heart failure, or in people with inherited arrhythmia syndromes.
3.	Ventricular fibrillation (VFib): This is a type of irregular heartbeat that originates in the ventricles. In VFib, the ventricles quiver instead of contracting, causing a complete loss of effective pumping action. VFib is a medical emergency and requires immediate defibrillation to restore a normal heartbeat. VFib is often associated with underlying heart disease, such as prior heart attack, but it can also occur in people with normal hearts.


Section 3: Methodology 
A. Project Research
The project research involves studying the techniques and methods used to monitor electrocardiogram (ECG) signals. The aim is to identify the best practices for processing and analyzing ECG signals to obtain vital information on the health status of an individual.

B. System Design
The system design involves designing a hardware and software system capable of monitoring ECG signals. The hardware system involves the use of an MCP3008 analog-to-digital converter (ADC) to sample the ECG signal from a patient. The software system involves the use of Python programming language, with the help of the spidev, os, datetime, numpy, tkinter, and matplotlib libraries. 
Incorporating a Python environment and machine learning models with these components can improve the accuracy and reliability of arrhythmia detection. The machine learning models can detect arrhythmias with high accuracy, and the system can alert the user in real-time to take necessary actions. Furthermore, using Python for signal processing, feature extraction, and model training allows for a flexible and modular design that can be adapted and extended with ease. Overall, this system design is the best choice for building a heart monitoring device that can detect different arrhythmias with high accuracy and reliability.
1.	Data Acquisition: The ECG electrodes and pulse sensors would capture analog signals, which would be processed by the MCP3008 ADC and ADC 8232, respectively. The Raspberry Pi would then read these digital signals.
2.	Data Preprocessing: The raw data would undergo preprocessing to remove any artifacts, baseline drift, and noise. Python libraries such as NumPy, Pandas, and SciPy can be used for this step.
3.	Feature Extraction: The preprocessed data would be used to extract relevant features from the ECG and pulse signals. These features could include heart rate variability, QRS complex, and P-wave duration. Python libraries such as SciPy, scikit-learn, and PyWavelets can be used for feature extraction.
4.	Machine Learning Models: The extracted features would then be used to train and test different machine learning models such as Random Forests, or Deep Learning models like Convolutional Neural Networks (CNNs). These models can be trained to identify different arrhythmias based on the extracted features.
5.	Real-time Monitoring and Alerting: The trained model would be integrated with the real-time monitoring system to classify the ECG and pulse signals and detect different arrhythmias. If an arrhythmia is detected, the system can generate alerts to notify the user or a medical professional for further actions.

C. Hardware Design
The hardware design involves connecting the MCP3008 ADC to a Raspberry Pi board using the Serial Peripheral Interface (SPI) protocol. The ECG signal is sampled using a single channel of the MCP3008 ADC, with the sampling frequency set to 1000 Hz.

1.	MCP3008 ADC: This is an Analog-to-Digital Converter (ADC) chip that can be used to convert analog signals from sensors to digital signals that can be processed by a microcontroller or a computer. The MCP3008 ADC is an 8-channel, 10-bit ADC that can be connected to a Raspberry Pi using the SPI interface. It is ideal for reading analog signals from sensors such as electrocardiogram (ECG) electrodes.
2.	ADC 8232: This is another ADC chip that can be used to read analog signals from sensors. The ADC 8232 is a single-channel, 12-bit ADC that can be connected to a Raspberry Pi using the I2C interface. It is ideal for reading analog signals from sensors such as pulse sensors or blood oxygen sensors.
3.	Raspberry Pi: This is a small, low-cost computer that can be used as the main processing unit for the heart monitoring device. The Raspberry Pi can be connected to the MCP3008 ADC and the ADC 8232 to read analog signals from sensors. It can also run software to process the signals and detect different arrhythmias.

D. Dataset and Preparation
The dataset used in this project is obtained from the PhysioNet database. The dataset consists of ECG signals recorded from healthy individuals and individuals with heart disease. The dataset is preprocessed by removing noise and baseline wander using a fourth-order Butterworth low-pass filter with a cutoff frequency of 40 Hz.

E. Machine Learning Model Creation
A machine learning model is created using the preprocessed dataset. The model is trained using a convolutional neural network (CNN) architecture. The CNN is designed to classify ECG signals as normal or abnormal.CNNs are specifically designed to learn spatial patterns from images or signals such as ECG signals. The ECG signals in the MIT-BIH dataset are essentially 1D signals that can be treated as images, and CNNs can learn important spatial patterns from these signals. By learning these patterns, the CNNs can classify the different arrhythmias with high accuracy.
ECG signals can be noisy, and preprocessing techniques such as filtering and denoising may not be enough to remove all the noise. CNNs are robust to noise and can learn to distinguish important features from noisy signals, making them an excellent choice for classifying arrhythmias.ECG signals can be complex and contain multiple features, such as P waves, QRS complexes, and T waves. CNNs can learn to recognize these complex features, making them effective for arrhythmia classification. In addition, CNNs can automatically learn relevant features from raw data, eliminating the need for manual feature engineering.The MIT-BIH dataset contains class imbalances, where certain arrhythmias are more prevalent than others. CNNs can handle class imbalances well by learning to give more weight to the underrepresented classes, improving the classification accuracy.

F. Model Evaluation
The performance of the CNN model is evaluated using the preprocessed dataset. The evaluation metrics used include accuracy, precision, recall, and F1 score. The results of the evaluation are used to determine the effectiveness of the CNN model in classifying ECG signals.
The given code defines and trains a Convolutional Neural Network (CNN) model for a multiclass classification task. The input data is electrocardiogram (ECG) signals, and the goal is to classify the signals into one of five categories (0, 1, 2, 3, or 4). Here's a detailed evaluation of the model:
Model architecture
The model consists of three convolutional layers, followed by three max pooling layers, and two dense layers. Each convolutional layer has 64 filters, and the filter sizes are 6, 3, and 3, respectively. Each max pooling layer has a pool size of 2 and stride of 2. The dense layers have 64 and 32 units, respectively, and both use ReLU activation. The output layer is a dense layer with 5 units and softmax activation.
Training
The model is trained using the Adam optimizer with a categorical cross-entropy loss function. The training is done for 40 epochs with an early stopping mechanism and a ModelCheckpoint to save the best model based on validation loss. The batch size is set to 32.
Evaluation
The trained model is evaluated on the test set, and the accuracy and loss are printed. The accuracy of the model on the test set is 98.30%.
After training, the evaluate_model function is called, which calculates and prints the accuracy of the model, plots the training and validation accuracy and loss, and generates a confusion matrix. The confusion matrix shows how many predictions the model made correctly and incorrectly for each class. The confusion matrix helps to understand which classes are hard to predict and can be used to guide future model improvements.


Section 4: Results

A. Results based on Validation methods

The heart rhythm classification device has been developed using advanced signal processing techniques and machine learning algorithms, specifically Convolutional Neural Networks (CNNs). The model was trained on a dataset of over 10,000 ECG recordings, labeled by expert cardiologists to indicate the type of arrhythmia present in each recording. The device can classify ECG signals with an accuracy of 98.3% and a loss of 0.10%

To evaluate the model's performance, the team used several validation methods, including k-fold cross-validation, leave-one-out cross-validation, and hold-out validation. In k-fold cross-validation, the dataset is divided into k subsets, and the model is trained and tested k times, each time using a different subset for testing and the remaining subsets for training. Leave-one-out cross-validation involves training the model on all but one sample and using the left-out sample for testing. Hold-out validation involves splitting the dataset into training and testing sets, where the training set is used to train the model and the testing set is used to evaluate its performance.
The results of the validation methods showed consistent high accuracy and low loss, indicating the robustness of the model. The team is currently working on improving the accuracy and graphical user interface of the device. The device's integration with a mobile application allows for easy monitoring of heart health and personalized recommendations and alerts to help individuals make informed decisions about their heart condition. The development of this heart rhythm classification device has the potential to revolutionize the way in which heart conditions are diagnosed and treated, ultimately leading to better patient outcomes.


Section 5: Conclusion
	The paper titled "Building Heart Rhythms Classification Device for Humans" presents a novel device that utilizes advanced signal processing techniques and machine learning algorithms to accurately classify different heart rhythms. The device provides real-time information about a person's heart rhythm and allows for early detection and treatment of heart problems. The device is designed to be user-friendly and portable, integrating with a mobile application that provides personalized recommendations and alerts to help individuals make informed decisions about their heart condition. The device can classify ECG signals with an accuracy of 98.3% and a loss of 0.10%. The development of this device has the potential to revolutionize the way in which heart conditions are diagnosed and treated, improving patient comfort and convenience by avoiding the need for invasive procedures to monitor heart vital signals. Future work includes improving the accuracy and graphical user interface of the device and integrating it with wearable devices, such as smartwatches. Overall, the paper highlights the importance of machine learning in the development of innovative medical devices that can significantly improve patient outcomes.


REFERENCES

X. Xu and H. Liu, "ECG Heartbeat Classification Using Convolutional Neural Networks," in IEEE Access, vol. 8, pp. 8614-8619, 2020, doi: 10.1109/ACCESS.2020.2964749.
Y. Yol, M. A. Ozdemir and A. Akan, "Design of Real Time Cardiac Arrhythmia Detection Device," 2019 Medical Technologies Congress (TIPTEKNO), Izmir, Turkey, 2019, pp. 1-4, doi: 10.1109/TIPTEKNO.2019.8894964.
P. Lussier and C. -H. Yu, "Applying IoT and Deep Learning for ECG Data Analysis," 2022 IEEE Global Conference on Artificial Intelligence and Internet of Things (GCAIoT), Alamein New City, Egypt, 2022, pp. 01-06, doi: 10.1109/GCAIoT57150.2022.10019169.
P. Patil and K. Bhole, "Real time ECG on internet using Raspberry Pi," 2018 International Conference on Communication, Computing and Internet of Things (IC3IoT), Chennai, India, 2018, pp. 267-270, doi: 10.1109/IC3IoT.2018.8668157.
